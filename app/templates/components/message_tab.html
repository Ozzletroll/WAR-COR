<nav id="messages-tab" class="notifications-dropdown" aria-label="Messages Tab" aria-hidden="true" tabindex="-1">
  
  {% if current_user.messages | length == 0 %}
    <div class="messages-upper no-messages-upper" aria-label="No Messages">
      <h5 id="no-messages" class="no-message-header" aria-label="No Messages">NO MESSAGES</h5>
      <div class="no-message-text-area">
        <p class="flavour-text no-message-flavour" aria-label="Message flavour text">
          //Communications:Online<br aria-hidden="true">
          //Satellite:Lock<br aria-hidden="true">
          >Awaiting Uplink_
        </p>
        <div class="no-message-flavour no-message-spacer"></div>
      </div>
    </div>
  {% elif current_user.messages | length >= 2 %}
    <div class="messages-upper" aria-label="View Message Count">
      <h4 class="message-count" aria-label="Message Count">{{current_user.messages | length}} New Messages</h4>
      <button id="dismiss-all" class="button message-button" tabindex="-1"
      onclick="handleMessage(event)"
      data-csrf="{{ csrf_token() }}"
      data-url="{{ url_for('user.dismiss_all') }}">
      DISMISS ALL
      </button>
    </div>
  {% endif %}

    {% if current_user.messages | length > 0 %}
    <ul id="notifications-list" class="notifications-list" aria-label="Messages">

      {% for message in current_user.messages | sort(attribute="date") | reverse %}
    
        {% if message.invite %}
    
          <li class="message-item" aria-label="Invite: {{ message.date }}">
            <h4 class="message-header">INVITE {{message.date}}</h4>   
            <p class=message-body aria-label="Message Text">{{message.body}}</p>
            <div class="message-button-area">

              <button id="message-accept-{{ message.id }}" class="button message-button accept-button" tabindex="-1" 
              onclick="handleMessage(event)"
              data-csrf="{{ csrf_token() }}"
              data-url="{{ url_for('membership.accept_invite') }}"
              data-campaign-id="{{ message.target_campaign.id }}"
              data-message-id="{{ message.id }}">
              ACCEPT
              </button>

              <button id="message-decline-{{ message.id }}" class="button message-button decline-button" tabindex="-1"
              onclick="handleMessage(event)"
              data-csrf="{{ csrf_token() }}"
              data-url="{{ url_for('membership.decline_invite') }}"
              data-campaign-id="{{ message.target_campaign.id }}"
              data-message-id="{{ message.id }}">
              DECLINE
              </button>

            </div>
          </li>
          
        {% elif message.notification %}
    
        <li class="message-item" aria-label="Alert: New Event {{ message.date }}">
          <h4 class="message-header">ALERT {{message.date}}</h4>
          <p class=message-body aria-label="Message Text">{{message.body}}</p>
          <div class="message-button-area">
            {% if message.target_event is not none %}
              <button id="view-message-{{ message.id }}" class="button message-button accept-button" tabindex="-1"
              onclick="handleMessage(event)"
              data-csrf="{{ csrf_token() }}"
              data-url="{{ url_for('user.dismiss_message', view=True) }}"
              data-campaign-id="{{ message.target_campaign.id }}"
              data-message-id="{{ message.id }}">
              VIEW
              </button>

            </a>
            {% endif %}

            <button id="dismiss-message-{{ message.id }}" class="button message-button decline-button" tabindex="-1"
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('user.dismiss_message') }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            DISMISS
            </button>

          </div>
        </li>
        {% elif message.request %}
    
          <li class="message-item">
            <h4 class="message-header">REQUEST {{message.date}}</h4>   
            <div class=message-body>{{message.body}}</div>
            <div class="message-button-area">

              <button id="invite-accept-{{ message.id }}" class="button message-button accept-button" tabindex="-1"
              onclick="handleMessage(event)"
              data-csrf="{{ csrf_token() }}"
              data-url="{{ url_for('membership.confirm_request') }}"
              data-campaign-id="{{ message.target_campaign.id }}"
              data-message-id="{{ message.id }}">
              ACCEPT
              </button>

              <button id="invite-decline-{{ message.id }}" class="button message-button decline-button" tabindex="-1"
              onclick="handleMessage(event)"
              data-csrf="{{ csrf_token() }}"
              data-url="{{ url_for('membership.deny_request') }}"
              data-campaign-id="{{ message.target_campaign.id }}"
              data-message-id="{{ message.id }}">
              DECLINE
              </button>

            </div>
          </li>
    
        {% endif %}
    
      {% endfor %}
    </ul>
    {% endif %}
  
  </nav>

<script src="{{ url_for('static', filename='/js/message_tab.js') }}"></script> 
