<div id="messages-tab" class="notifications-dropdown">
  
    <ul class="notifications-list">
    {% if current_user.messages | length == 0 %}
      
      <li class="message-item">
        <h5 class="no-message-header">NO MESSAGES</h5>
        <div class="no-message-text-area">
          <p class="flavour-text no-message-flavour">//Communications:Online</p>
          <p class="flavour-text no-message-flavour">//Satellite:Lock</p>
          <p class="flavour-text no-message-flavour no-message-spacer">>Awaiting Uplink_</p>
        </div>
      </li>
  
    {% endif %}
  
    {% if current_user.messages | length >= 2 %}
  
      <h4 class="message-count">{{current_user.messages | length}} New Messages</h4>
      
        <button id="dismiss-all" class="button message-button" 
        onclick="handleMessage(event)"
        data-csrf="{{ csrf_token() }}"
        data-url="{{ url_for('user.dismiss_all') }}">
        DISMISS ALL
        </button>

    {% endif %}
  
    {% for message in current_user.messages | sort(attribute="date") | reverse %}
  
      {% if message.invite %}
  
        <h5 class="message-date">{{message.date}}</h5>
  
        <li class="message-item">
          <h4 class="message-header">INVITE</h4>   
          <div class=message-body>{{message.body}}</div>
          <div class="message-button-area">

            <button id="message-accept-{{ message.id }}" class="button message-button accept-button" 
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('membership.accept_invite') }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            ACCEPT
            </button>

            <button id="message-decline-{{ message.id }}" class="button message-button decline-button" 
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('membership.decline_invite') }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            DECLINE
            </button>

          </div>
        </li>
        
      {% elif message.notification %}
  
      <h5 class="message-date">{{message.date}}</h5>
  
      <li class="message-item">
        <h4 class="message-header">ALERT</h4>
        <div class=message-body>{{message.body}}</div>
        <div class="message-button-area">
          {% if message.target_event is not none %}
            <button id="view-message-{{ message.id }}" class="button message-button accept-button" 
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('user.dismiss_message', view=True) }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            VIEW
            </button>

          </a>
          {% endif %}

          <button id="dismiss-message-{{ message.id }}" class="button message-button decline-button" 
          onclick="handleMessage(event)"
          data-csrf="{{ csrf_token() }}"
          data-url="{{ url_for('user.dismiss_message') }}"
          data-campaign-id="{{ message.target_campaign.id }}"
          data-message-id="{{ message.id }}">
          DISMISS
          </button>

        </div>
      </li>
      {% elif message.request %}
  
        <h5 class="message-date">{{message.date}}</h5>
  
        <li class="message-item">
          <h4 class="message-header">REQUEST</h4>   
          <div class=message-body>{{message.body}}</div>
          <div class="message-button-area">

            <button id="invite-accept-{{ message.id }}" class="button message-button accept-button" 
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('membership.confirm_request') }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            ACCEPT
            </button>

            <button id="invite-decline-{{ message.id }}" class="button message-button decline-button" 
            onclick="handleMessage(event)"
            data-csrf="{{ csrf_token() }}"
            data-url="{{ url_for('membership.deny_request') }}"
            data-campaign-id="{{ message.target_campaign.id }}"
            data-message-id="{{ message.id }}">
            DECLINE
            </button>

          </div>
        </li>
  
      {% endif %}
  
    {% endfor %}
    </ul>
  
</div>

<script src="{{ url_for('static', filename='/js/message_tab.js') }}"></script> 
